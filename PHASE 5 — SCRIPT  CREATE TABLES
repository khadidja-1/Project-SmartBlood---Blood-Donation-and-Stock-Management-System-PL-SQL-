CREATE TABLE DONOR (
    DONOR_ID        NUMBER GENERATED ALWAYS AS IDENTITY PRIMARY KEY,
    FIRST_NAME      VARCHAR2(50) NOT NULL,
    LAST_NAME       VARCHAR2(50) NOT NULL,
    DATE_OF_BIRTH   DATE NOT NULL,
    GENDER          VARCHAR2(10),
    BLOOD_TYPE      VARCHAR2(5) NOT NULL,
    PHONE           VARCHAR2(20),
    EMAIL           VARCHAR2(100),
    ADDRESS         VARCHAR2(200),
    CREATED_AT      DATE DEFAULT SYSDATE
);
CREATE TABLE DONATION_APPOINTMENT (
    APPOINTMENT_ID  NUMBER GENERATED ALWAYS AS IDENTITY PRIMARY KEY,
    DONOR_ID        NUMBER NOT NULL,
    APPOINTMENT_DATE DATE NOT NULL,
    STATUS          VARCHAR2(20) DEFAULT 'SCHEDULED',

    CONSTRAINT fk_appointment_donor
        FOREIGN KEY (DONOR_ID)
        REFERENCES DONOR(DONOR_ID)
        ON DELETE CASCADE
);
CREATE TABLE BLOOD_COLLECTION (
    COLLECTION_ID   NUMBER GENERATED ALWAYS AS IDENTITY PRIMARY KEY,
    APPOINTMENT_ID  NUMBER NOT NULL,
    COLLECTION_DATE DATE NOT NULL,
    LOCATION        VARCHAR2(100),

    CONSTRAINT fk_collection_appointment
        FOREIGN KEY (APPOINTMENT_ID)
        REFERENCES DONATION_APPOINTMENT(APPOINTMENT_ID)
        ON DELETE CASCADE
);
CREATE TABLE LAB_TEST (
    TEST_ID         NUMBER GENERATED ALWAYS AS IDENTITY PRIMARY KEY,
    COLLECTION_ID   NUMBER NOT NULL,
    TEST_TYPE       VARCHAR2(50) NOT NULL,
    RESULT          VARCHAR2(20),
    TEST_DATE       DATE DEFAULT SYSDATE,

    CONSTRAINT fk_labtest_collection
        FOREIGN KEY (COLLECTION_ID)
        REFERENCES BLOOD_COLLECTION(COLLECTION_ID)
        ON DELETE CASCADE
);
CREATE TABLE BLOOD_UNIT (
    UNIT_ID         NUMBER GENERATED ALWAYS AS IDENTITY PRIMARY KEY,
    COLLECTION_ID   NUMBER NOT NULL,
    BLOOD_TYPE      VARCHAR2(5) NOT NULL,
    EXPIRATION_DATE DATE NOT NULL,

    CONSTRAINT fk_unit_collection
        FOREIGN KEY (COLLECTION_ID)
        REFERENCES BLOOD_COLLECTION(COLLECTION_ID)
        ON DELETE CASCADE
);
CREATE TABLE BLOOD_STOCK (
    STOCK_ID    NUMBER GENERATED ALWAYS AS IDENTITY PRIMARY KEY,
    UNIT_ID     NUMBER NOT NULL,
    LOCATION    VARCHAR2(50) DEFAULT 'MAIN STORAGE',
    STATUS      VARCHAR2(20) DEFAULT 'AVAILABLE',

    CONSTRAINT fk_stock_unit
        FOREIGN KEY (UNIT_ID)
        REFERENCES BLOOD_UNIT(UNIT_ID)
        ON DELETE CASCADE
);
CREATE TABLE HOSPITAL (
    HOSPITAL_ID     NUMBER GENERATED ALWAYS AS IDENTITY PRIMARY KEY,
    NAME            VARCHAR2(100) NOT NULL,
    ADDRESS         VARCHAR2(200),
    PHONE           VARCHAR2(20)
);
CREATE TABLE BLOOD_REQUEST (
    REQUEST_ID      NUMBER GENERATED ALWAYS AS IDENTITY PRIMARY KEY,
    HOSPITAL_ID     NUMBER NOT NULL,
    UNIT_ID         NUMBER NOT NULL,
    REQUEST_DATE    DATE DEFAULT SYSDATE,
    STATUS          VARCHAR2(20) DEFAULT 'PENDING',

    CONSTRAINT fk_request_hospital
        FOREIGN KEY (HOSPITAL_ID)
        REFERENCES HOSPITAL(HOSPITAL_ID),

    CONSTRAINT fk_request_unit
        FOREIGN KEY (UNIT_ID)
        REFERENCES BLOOD_UNIT(UNIT_ID)
);CREATE TABLE TRANSFUSION (
    TRANSFUSION_ID  NUMBER GENERATED ALWAYS AS IDENTITY PRIMARY KEY,
    REQUEST_ID      NUMBER NOT NULL,
    TRANSFUSION_DATE DATE NOT NULL,
    PATIENT_NAME    VARCHAR2(100),

    CONSTRAINT fk_transfusion_request
        FOREIGN KEY (REQUEST_ID)
        REFERENCES BLOOD_REQUEST(REQUEST_ID)
);



